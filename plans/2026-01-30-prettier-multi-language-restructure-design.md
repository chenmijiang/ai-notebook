# Prettier 多语言支持指南重构设计

## 背景

当前 `prettier-3-multi-language.md` 第四节存在以下问题：

1. **主题混杂**：解析器、插件、配置混在一起讲，缺乏清晰的逻辑线
2. **层次不清**：概念介绍和实操配置没有分开，读起来跳跃
3. **解析器综合对照表位置不当**：放在正文中干扰阅读，应移到总结/附录便于快速查阅
4. **缺失打印器介绍**：没有讲解打印器如何使用 options 影响格式化输出

## 重构方案

将原第四节拆分为两个独立章节，并重组总结章节：

- 第 4 节：解析器与打印器（概念层面）
- 第 5 节：插件扩展（实操层面）
- 第 6 节：总结与速查（参考手册）

## 详细设计

### 第 4 节：解析器与打印器

**目标**：聚焦概念层面，让读者理解 Prettier 多语言支持的工作原理。

```
第 4 节：解析器与打印器
├── 4.1 工作流程概述
│   - 源码 → 解析器 → AST → 打印器 → 格式化输出
│   - 简明流程图（保留现有的，但移除对照表）
│
├── 4.2 解析器（Parser）
│   - 作用：将源码解析为 AST
│   - 不同语言使用不同解析器（babel、typescript、css 等）
│   - 同一语言可能有多个可选解析器（如 JS 有 babel/espree/acorn）
│
├── 4.3 打印器（Printer）【新增内容】
│   - 作用：读取 AST + options，输出格式化代码
│   - 每种语言有对应的打印器
│   - options 如何影响输出：以 JS 和 HTML 为例
│     - JS 打印器读取 semi、singleQuote 等
│     - HTML 打印器读取 htmlWhitespaceSensitivity 等
│   - 为什么不同语言有不同的专用选项
│
└── 4.4 解析器选择机制
    - Prettier 如何自动选择解析器（流程图保留）
    - 何时需要手动指定解析器
```

### 第 5 节：插件扩展

**目标**：聚焦实操层面，讲解如何通过插件扩展 Prettier 的语言支持。

```
第 5 节：插件扩展
├── 5.1 插件的作用
│   - 插件 = 解析器 + 打印器（为新语言提供支持）
│   - 插件的三种能力：新增语言、修改现有行为、新增配置选项
│   - 简要展示插件结构（保留现有的代码示例，精简）
│
├── 5.2 插件加载机制
│   - 自动发现（Prettier 3.x 扫描 node_modules）
│   - 命名模式：prettier-plugin-*、@*/prettier-plugin-* 等
│   - 显式配置：plugins 数组
│   - 加载顺序的影响
│
├── 5.3 常用社区插件
│   - 官方插件表格（PHP、XML、Ruby、Pug）
│   - 社区热门插件表格（Tailwind、Svelte、Astro 等）
│   - 按功能分类说明
│
└── 5.4 插件配置示例
    - Tailwind CSS 插件配置 + 效果展示
    - Svelte 插件配置
    - 多插件配置（注意加载顺序）
    - 验证插件是否生效的命令
```

### 第 6 节：总结与速查

**目标**：汇总核心要点和参考表格，便于快速查阅。

```
第 6 节：总结与速查
├── 6.1 核心要点回顾
│   - 保留现有内容（内置语言、解析器选择、overrides、插件、优先级）
│
├── 6.2 解析器综合对照表 ← 从 4.1 移到这里
│   - 完整的解析器表格（解析器、语言、扩展名、底层实现、说明）
│   - 作为参考手册使用，不在正文中干扰阅读
│
├── 6.3 多语言配置速查表
│   - 保留现有内容（语言、解析器、关键选项）
│
└── 6.4 常见问题速查
    - 保留现有内容
```

## 内容变更说明

### 新增内容

- **4.3 打印器（Printer）**：从多语言角度讲解打印器如何使用 options 影响格式化输出

### 移动内容

- **解析器综合对照表**：从 4.1 移动到 6.2

### 保留内容

- 第 1-3 节保持不变
- 原 4.2-4.5 内容保留，重组为新的第 5 节
- 原第 5 节总结内容保留，扩展为新的第 6 节

### 删除内容

- 无

## 实施步骤

1. 重写第 4 节，聚焦解析器与打印器概念
2. 新增 4.3 打印器小节
3. 将原 4.2-4.5 重组为新的第 5 节（插件扩展）
4. 将解析器综合对照表移动到第 6 节
5. 更新文档内部的交叉引用链接
6. 更新文末的"下一步"指引
